var fastHttp=function(){"use strict";function t(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":l(t))}function e(t){return"function"==typeof t}function n(t){return null!==t&&"undefined"!=typeof obj}function o(t){return n(window.FormData)&&t instanceof window.FormData}function r(t){return window.encodeURIComponent?window.encodeURIComponent(t):t}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null===t)return null;var e=Object.keys(t).map(function(e){return r(e)+"="+r(t[e])});return e.join("&").replace(/%20/g,"+")}function a(t,e){var n=u(e);return n?t+(t.indexOf("?")===-1?"?":"&")+n:t}function i(e){if(t(e))return e;try{e=window.JSON.parse(e)}catch(t){e=null}return e}function s(t){return new Promise(function(e,n){var o=y.jsonp.result,r=t.jsonpCallback||y.jsonp.jsonpCallback,u=y.jsonp.callbackPrefix+(new Date).getTime();window[u]=function(t){o=t},t.params=t.params||{},t.params[r]=u;var i=function(t){var r=t.type;"load"===r&&null!==o?e({status:200,statusText:"",result:o}):n({status:"error"===r?500:0,statusText:"",result:o}),delete window[u],document.body.removeChild(s)},s=document.createElement("script");s.src=a(t.url,t.params),s.type="text/javascript",s.async=t.async||y.async,s.onload=i,s.onerror=i,document.body.appendChild(s)})}function c(t){t=this.getRequest(t);var n=this.defaultValue,r=(t.method||n.method).toUpperCase();return"JSONP"===r?s(t):new Promise(function(s,c){var l=a(t.url,t.params),p=t.async||n.async,f=t.dataType,y=t.credentials||n.credentials,d=t.timeout||n.timeout,m=t.body||n.body,h=t.headers||{},v=new XMLHttpRequest,w=function(t){var e=t.type,n=v.status||0,o=v.statusText||"";"timeout"===e&&(n=408,o="è¯·æ±‚è¶…æ—¶");var r={status:n,statusText:o,result:i(v.responseText)};r.status>=200&&r.status<300?s(r):c(r)};if(v.open(r,l,p),"withCredentials"in v&&(v.withCredentials=y),!h.Accept){var b=n.headers.Accept;h.Accept=b[f]||b[n.dataType]}o(m)?delete h["Content-Type"]:(m=u(m),h["Content-Type"]||(h["Content-Type"]=n.headers["Content-Type"])),e(v.setRequestHeader)&&Object.keys(h).forEach(function(t){v.setRequestHeader(t,h[t])}),v.timeout=d,v.onload=w,v.onerror=w,v.ontimeout=w,v.onprogress=t.onprogress||null,v.send(m)})}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=(function(){function t(t){this.value=t}function e(e){function n(t,e){return new Promise(function(n,r){var i={key:t,arg:e,resolve:n,reject:r,next:null};a?a=a.next=i:(u=a=i,o(t,e))})}function o(n,u){try{var a=e[n](u),i=a.value;i instanceof t?Promise.resolve(i.value).then(function(t){o("next",t)},function(t){o("throw",t)}):r(a.done?"return":"normal",a.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":u.resolve({value:e,done:!0});break;case"throw":u.reject(e);break;default:u.resolve({value:e,done:!1})}u=u.next,u?o(u.key,u.arg):a=null}var u,a;this._invoke=n,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),y={method:"get",async:!0,dataType:"*",credentials:!1,timeout:0,body:null,params:null,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:{"*":"*/*",json:"application/json",text:"text/plain"}},jsonp:{jsonpCallback:"callback",callbackPrefix:"fast_http_",result:null}},d=function(){function t(e){p(this,t),this.options=e||{},this.defaultValue=y,this.request=c}return f(t,[{key:"setOptions",value:function(t){this.options=Object.assign({},this.options,t)}},{key:"isProxy",value:function(){var t=this.options.proxy;return!!(t&&t.from&&t.to)}},{key:"getRequest",value:function(t){if(this.isProxy()){var e=this.options.proxy;t.url=t.url.replace(e.from,e.to),t.params._method=t.method,t.params._author="liancheng",t.method="jsonp"}return t}}]),t}(),m=new d;return m}();
